# es2018(es9)æ–°ç‰¹æ€§

å‚è€ƒåšå®¢ 
[å‰ç«¯å¼€å‘](https://www.html.cn/archives/9990)  
[æ‹‰ä¸çš„ä¼ è¯´](https://www.imooc.com/article/37899)  
***

## 1.Rest(å‰©ä½™)/Spread(å±•å¼€) å±æ€§

ES6 åœ¨å¤„ç†æ•°ç»„è§£æ„æ—¶,å¼•å…¥äº† rest(å‰©ä½™)/Spread(å±•å¼€)å…ƒç´ çš„æ¦‚å¿µï¼Œä¾‹å¦‚ï¼š
```js
//rest
const numbers = [1, 2, 3, 4, 5];
[first, second, ...others] = numbers;
first // 1
second // 2
others // [3, 4, 5]

//Spread
const arr = [first, second, ...others];
arr // [1, 2, 3, 4, 5]
```

ES2018 ä¸ºå¯¹è±¡å¼•å…¥äº†ç±»ä¼¼çš„åŠŸèƒ½ã€‚
```js
//rest
const { first, second, ...others } = { first: 1, second: 2, third: 3, fourth: 4, fifth: 5 }
first // 1
second // 2
others // { third: 3, fourth: 4, fifth: 5 }

//Spread
const items = { first, second, ...others };
items //{ first: 1, second: 2, third: 3, fourth: 4, fifth: 5 }
```

## 2.Asynchronous iteration ï¼ˆå¼‚æ­¥è¿­ä»£ï¼‰

åœ¨async/awaitçš„æŸäº›æ—¶åˆ»ï¼Œä½ å¯èƒ½å°è¯•åœ¨åŒæ­¥å¾ªç¯ä¸­è°ƒç”¨å¼‚æ­¥å‡½æ•°ã€‚ä¾‹å¦‚ï¼š
```js
async function process(array) {   
    for (let i of array) {    
         await doSomething(i);   
    } 
}
//è¿™æ®µä»£ç ä¸ä¼šæ­£å¸¸è¿è¡Œï¼Œä¸‹é¢è¿™æ®µåŒæ ·ä¹Ÿä¸ä¼š;
async function process(array) {   
    array.forEach(async (i) => {     
        await doSomething(i);   
    }); 
}
```
è¿™æ®µä»£ç ä¸­ï¼Œå¾ªç¯æœ¬èº«ä¾æ—§ä¿æŒåŒæ­¥ï¼Œå¹¶åœ¨åœ¨å†…éƒ¨å¼‚æ­¥å‡½æ•°ä¹‹å‰å…¨éƒ¨è°ƒç”¨å®Œæˆã€‚  

ES2018å¼•å…¥å¼‚æ­¥è¿­ä»£å™¨ï¼ˆasynchronous iteratorsï¼‰ï¼Œè¿™å°±åƒå¸¸è§„è¿­ä»£å™¨ï¼Œé™¤äº†next()æ–¹æ³•è¿”å›ä¸€ä¸ªPromiseã€‚å› æ­¤awaitå¯ä»¥å’Œfor...ofå¾ªç¯ä¸€èµ·ä½¿ç”¨ï¼Œä»¥ä¸²è¡Œçš„æ–¹å¼è¿è¡Œå¼‚æ­¥æ“ä½œã€‚
```js
async function process(array) {   
    for await (let i of array) {     
        doSomething(i);   
    } 
}

```

## 3.Promise.finally()

ä¸€ä¸ªPromiseè°ƒç”¨é“¾è¦ä¹ˆæˆåŠŸåˆ°è¾¾æœ€åä¸€ä¸ª.then()ï¼Œè¦ä¹ˆå¤±è´¥è§¦å‘.catch()ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä½ æƒ³è¦åœ¨æ— è®ºPromiseè¿è¡ŒæˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œè¿è¡Œç›¸åŒçš„ä»£ç ï¼Œä¾‹å¦‚æ¸…é™¤ï¼Œåˆ é™¤å¯¹è¯ï¼Œå…³é—­æ•°æ®åº“è¿æ¥ç­‰ã€‚

.finally()å…è®¸ä½ æŒ‡å®šæœ€ç»ˆçš„é€»è¾‘
```js
function doSomething() {   
    doSomething1()   
    .then(doSomething2)    
    .catch(err => {     
        console.log(err);   
    })   
    .finally(() => {     
        // finish here!   
    }); 
}

```

## 4.æ­£åˆ™è¡¨è¾¾å¼æ”¹è¿›

### å…ˆè¡Œæ–­è¨€(lookahead)å’Œåè¡Œæ–­è¨€(lookbehind)
ä¸‹é¢æ˜¯ä¸€ä¸ªå…ˆè¡Œæ–­è¨€(lookahead)ï¼šæ‚¨å¯ä»¥ä½¿ç”¨ `?=` åŒ¹é…ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²åé¢è·Ÿç€ä¸€ä¸ªç‰¹å®šçš„å­å­—ç¬¦ä¸²ï¼š  
```js
/Roger(?=Waters)/
 
/Roger(?= Waters)/.test('Roger is my dog') //false
/Roger(?= Waters)/.test('Roger is my dog and Roger Waters is a famous musician') //true
```
`?!` æ‰§è¡Œé€†æ“ä½œï¼ŒåŒ¹é…ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œè¯¥å­—ç¬¦ä¸²åé¢æ²¡æœ‰ä¸€ä¸ªç‰¹å®šçš„å­å­—ç¬¦ä¸²
```js
/Roger(?!Waters)/
 
/Roger(?! Waters)/.test('Roger is my dog') //true
/Roger(?! Waters)/.test('Roger Waters is a famous musician') //false
```
  
åè¡Œæ–­è¨€(lookbehind)ï¼Œæ˜¯ä¸€ä¸ªæ–°åŠŸèƒ½ï¼Œä½¿ç”¨ `?< =`
```js
/(?<=Roger) Waters/
 
/(?<=Roger) Waters/.test('Pink Waters is my dog') //false
/(?<=Roger) Waters/.test('Roger is my dog and Roger Waters is a famous musician') //true
```
åè¡Œæ–­è¨€(lookbehind) é€†æ“ä½œï¼Œä½¿ç”¨ `?< !`
```js
/(?<!Roger) Waters/
 
/(?<!Roger) Waters/.test('Pink Waters is my dog') //true
/(?<!Roger) Waters/.test('Roger is my dog and Roger Waters is a famous musician') //false
```

### Unicode å±æ€§è½¬ä¹‰ \p{â€¦} å’Œ \P{â€¦}
åœ¨æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ \d åŒ¹é…ä»»ä½•æ•°å­—ï¼Œ\s åŒ¹é…ä»»ä½•ä¸ä¸ºç©ºæ ¼çš„å­—ç¬¦ï¼Œ\w åŒ¹é…ä»»ä½•å­—æ¯æ•°å­—å­—ç¬¦ï¼Œä¾æ­¤ç±»æ¨ã€‚  
ä»»ä½• unicode å­—ç¬¦éƒ½æœ‰ä¸€ç»„å±æ€§ã€‚ ä¾‹å¦‚ï¼ŒScript ç¡®å®šè¯­è¨€ç³»åˆ—ï¼ŒASCII æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œ å¯¹äº ASCII å­—ç¬¦ï¼Œå€¼ä¸º trueï¼Œä¾æ­¤ç±»æ¨ã€‚ æ‚¨å¯ä»¥å°†æ­¤å±æ€§æ”¾åœ¨èŠ±æ‹¬å·ä¸­ï¼Œæ­£åˆ™è¡¨è¾¾å¼å°†æ£€æŸ¥æ˜¯å¦ä¸ºçœŸï¼š  
```js
/^\p{ASCII}+$/u.test('abc')   //âœ…
/^\p{ASCII}+$/u.test('ABC@')  //âœ…
/^\p{ASCII}+$/u.test('ABCğŸ™ƒ') //âŒ
```
ASCII_Hex_Digit æ˜¯å¦ä¸€ä¸ªå¸ƒå°”å±æ€§ï¼Œç”¨äºæ£€æŸ¥å­—ç¬¦ä¸²æ˜¯å¦ä»…åŒ…å«æœ‰æ•ˆçš„åå…­è¿›åˆ¶æ•°å­—ï¼š
```js
/^\p{ASCII_Hex_Digit}+$/u.test('0123456789ABCDEF') //âœ…
/^\p{ASCII_Hex_Digit}+$/u.test('h')                //âŒ
```
è¿˜æœ‰è®¸å¤šå…¶ä»–å¸ƒå°”å±æ€§ï¼Œæ‚¨åªéœ€é€šè¿‡åœ¨èŠ±æ‹¬å·ä¸­æ·»åŠ å®ƒä»¬çš„åç§°æ¥æ£€æŸ¥å®ƒä»¬ï¼ŒåŒ…æ‹¬ Uppercase, Lowercase, White_Space, Alphabetic, Emoji ç­‰ï¼š
```js
/^\p{Lowercase}$/u.test('h') //âœ…
/^\p{Uppercase}$/u.test('H') //âœ…
 
/^\p{Emoji}+$/u.test('H')   //âŒ
/^\p{Emoji}+$/u.test('ğŸ™ƒğŸ™ƒ') //âœ…
```
é™¤äº†è¿™äº›äºŒè¿›åˆ¶å±æ€§ä¹‹å¤–ï¼Œæ‚¨è¿˜å¯ä»¥æ£€æŸ¥ä»»ä½• unicode å­—ç¬¦å±æ€§ä»¥åŒ¹é…ç‰¹å®šå€¼ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘æ£€æŸ¥å­—ç¬¦ä¸²æ˜¯ç”¨å¸Œè…Šè¯­è¿˜æ˜¯æ‹‰ä¸å­—æ¯å†™çš„ï¼š
```js
/^\p{Script=Greek}+$/u.test('ÎµÎ»Î»Î·Î½Î¹Îº?') //âœ…
/^\p{Script=Latin}+$/u.test('hey') //âœ…
```
æ‚¨å¯ä»¥ç›´æ¥åœ¨ææ¡ˆä¸Šé˜…è¯»å¯ä½¿ç”¨çš„ [æ‰€æœ‰å±æ€§](https://github.com/tc39/proposal-regexp-unicode-property-escapes)   

### å‘½åæ•è·ç»„ï¼ˆNamed capturing groupsï¼‰
åœ¨ ES2018 ä¸­ï¼Œå¯ä»¥ä¸ºæ•è·ç»„åˆ†é…ä¸€ä¸ªåç§°ï¼Œè€Œä¸æ˜¯ä»…åœ¨ç»“æœæ•°ç»„ä¸­åˆ†é…ä¸€ä¸ª slotï¼ˆæ’æ§½ï¼‰ï¼š  
```js
const re = /(?<year>\d{4})-(?<month>\d{2})-(?<day>\d{2})/
const result = re.exec('2015-01-02')
 
// result.groups.year === '2015';
// result.groups.month === '01';
// result.groups.day === '02';
```

### æ­£åˆ™è¡¨è¾¾å¼çš„ â€˜sâ€™ æ ‡å¿—

`s` æ ‡å¿—æ˜¯ â€˜single line'(å•è¡Œ)çš„ç¼©å†™ï¼Œå®ƒä½¿ . åŒ¹é…æ–°çš„è¡Œå­—ç¬¦ã€‚å¦‚æœæ²¡æœ‰å®ƒï¼Œç‚¹å°†åŒ¹é…æ™®é€šå­—ç¬¦ï¼Œè€Œä¸æ˜¯æ–°è¡Œï¼š
```js
/hi.welcome/.test('hi\nwelcome') // false
/hi.welcome/s.test('hi\nwelcome') // true
```
***